\documentclass[twoside,a5paper,10pt,openright]{memoir}
% \setstocksize{230mm}{160mm}
\setlrmarginsandblock{23mm}{20mm}{*}
\setulmarginsandblock{20mm}{20mm}{*}
\checkandfixthelayout

\usepackage[utf8]{inputenc}
\usepackage[english]{babel}
\usepackage[style=authoryear,maxbibnames=99,giveninits=true]{biblatex}
\addbibresource{references.bib}

\usepackage{amsmath}
\usepackage{mathtools}
\usepackage[colorlinks]{hyperref}
\usepackage{fontspec}
\usepackage{sourcesanspro}
\usepackage{unicode-math}
\usepackage{graphicx}
\usepackage[super]{nth}
\usepackage{booktabs}
\usepackage{csquotes}
\usepackage{multirow}
\usepackage[table]{xcolor}

\usepackage{cleveref}
\newcommand\pcref[1]{(\cref{#1})}

\usepackage[Bjornstrup]{fncychap}

\usepackage{tikz}
\usetikzlibrary{shapes, arrows.meta, positioning, shapes.geometric}

\usepackage{titling}
\usepackage[most]{tcolorbox}
\usepackage{xhfill}

\usepackage{qrcode}
\newcommand{\linkwithqr}[1]{%
  \begin{minipage}{0.8\textwidth}
    \url{#1}
  \end{minipage}
  \hfill
  \begin{minipage}{0.15\textwidth}
    \qrcode[height=\textwidth]{#1}
  \end{minipage}
}

\newcommand{\aurl}{google.com}
\newenvironment{parwithqr}[1]{%
  \renewcommand\aurl{#1}%
  \noindent%
  \begin{minipage}{0.75\textwidth}%
}{%
  \end{minipage}%
  \hfill%
  \begin{minipage}{0.20\textwidth}%
    \qrcode[height=\textwidth]{\aurl}%
  \end{minipage}%
}

\nonfrenchspacing

\begin{document}

\setmathfont{STIXTwoMath}[
  Extension={.otf},
  Path={./fonts/},
  Scale=1]

\setmainfont{STIXTwoText}[
  Extension={.otf},
  Path={./fonts/},
  UprightFont={*-Regular},
  BoldFont={*-Bold},
  ItalicFont={*-Italic},
  BoldItalicFont={*-BoldItalic}]

%\setsansfont{SourceSansPro}

\urlstyle{rm}

\tcbset {
  base/.style={
    arc=0mm,
    bottomtitle=0.5mm,
    boxrule=0mm,
    colbacktitle=black!20!white,
    coltitle=black,
    left=2.5mm,
    leftrule=1mm,
    right=3.5mm,
    title={#1},
    toptitle=0.75mm,
    lower separated=false,
  }
}

\newtcbtheorem[auto counter, number within=chapter]{slidebox}{Slide}{
  float=th,
  colframe=black!20!white,
  base
}{sld}

\newtcbtheorem[auto counter, number within=chapter]{defbox}{Definition}{
  float=h!,
  colframe=black!20!white,
  base
}{def}

\newtcolorbox{mainbox}[1]{
  float=ht,
  colframe=black!20!white,
  fonttitle=\bfseries,
  base={#1}
}

\newtcolorbox[blend into=figures]{figurebox}[2][]{%
  float=thbp, base={#2},
  colframe=black!20!white,
  every float=\centering, #1}

\newtcolorbox[blend into=tables]{tablebox}[2][]{%
  float=thbp, base={#2},
  colframe=black!20!white,
  every float=\centering, #1}

\newcommand\boxsubtitle[1]{%
  \vspace{0.5em}
  \noindent\xrfill[0.5ex]{1pt}[black!20]\phantom{x}\textbf{#1}\phantom{x}\xrfill[0.5ex]{1pt}[black!20]%
  \vspace{0.5em}
}

\renewcommand{\vec}[1]{\mathbf{#1}}

\title{Data science continuum: from foundations to practices}
\author{Filipe A. N. Verri}

\hypersetup{%
  pdftitle={\thetitle},
  pdfsubject={Data science},
  pdfauthor={\theauthor},
  pdfkeywords={data science, statistics, machine learning, databases},
  urlcolor=black!60,
  linkcolor=black,
  citecolor=black,}

\begin{titlingpage}
  \begin{tikzpicture}[remember picture, overlay]
    \fill[black!80] (current page.south west) rectangle (current page.north east);
    \node[anchor=south east, inner sep=0mm] at (current page.south east) {%
      \reflectbox{\includegraphics[width=\paperwidth]{images/bard2.jpg}}%
    };
    \node[white,anchor=north, yshift=-25mm](title) at (current page.north) {\HUGE\sffamily\uppercase{Data science continuum}};
    \node[white,anchor=north, inner sep=5mm] at (title.south) {\LARGE\sffamily\uppercase{from foundations to practices}};
    \node[anchor=south west, inner sep=11mm] at (current page.south west) {\HUGE\sffamily\uppercase{F.A.N. Verri}};
  \end{tikzpicture}
\end{titlingpage}

\newpage
\clearpage
\newpage
\frontmatter
\thispagestyle{empty}
\begin{tikzpicture}[remember picture, overlay]
  \node[anchor=south east, inner sep=8mm] at (current page.south east) {%
    \reflectbox{\includegraphics[height=0.6\paperheight]{images/toucan_bw.png}}%
  };
  \node[anchor=south east, inner sep=10mm] at (current page.south east) {\large\sffamily\textcolor{black!60}\today};
  \node[anchor=north, yshift=-25mm](title) at (current page.north) {\HUGE\sffamily\uppercase{Data science continuum}};
  \node[anchor=north, inner sep=5mm](subtitle) at (title.south) {\LARGE\sffamily\uppercase{from foundations to practices}};
  \node[anchor=north, inner sep=5mm] at (subtitle.south) {\Large\sffamily\uppercase{Filipe A. N. Verri}};
  \node[red,anchor=south west, inner sep=11mm] at (current page.south west) {\HUGE\sffamily WIP};
\end{tikzpicture}

\newpage
\mbox{}
\vfill

{
  \footnotesize\noindent\color{red}
  \textbf{Disclaimer:} This version is a work in progress.  Many parts of the book have
  been drafted with the help of \href{https://github.com/features/copilot}{GitHub Copilot}
  and may not be revised yet by the author.  The author is not responsible for any
  misinformation contained in this book.
}

\vspace{0.5cm}
{
\footnotesize\noindent
Book cover image was created with the assistance of
\href{https://gemini.google.com}{Gemini} and \href{https://openai.com/dall-e-2}{DALL·E 2}.
}

\vspace{0.5cm}
{
\footnotesize\noindent
Scripture quotations are from The ESV® Bible (The Holy Bible, English Standard Version®),
copyright © 2001 by Crossway, a publishing ministry of Good News Publishers. Used by
permission. All rights reserved.
}

\vspace{0.5cm}
{
\footnotesize\noindent
\thetitle{} © 2023--\the\year{} by \theauthor{} is licensed under
Attribution-NonCommercial-NoDerivatives 4.0 International. To view a copy of this license,
visit
\href{http://creativecommons.org/licenses/by-nc-nd/4.0/}{creativecommons.org/licenses/by-nc-nd/4.0}.
}

\thispagestyle{empty}
\newpage

\tableofcontents
\thispagestyle{empty}

\input{about}
\input{courses}

\mainmatter
\input{history}
\input{preliminaries}
\input{data}
\input{project}
\input{inductive}
\input{handling}
\input{tasks}
\input{evaluation}
\input{ethics}

\printbibliography

\end{document}
